<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin Panel – Data Kader</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js"></script>
</head>
<body class="bg-gray-100 p-6">

<h1 class="text-2xl font-bold mb-4 text-center">Admin Panel – Data Kader</h1>

<div class="mb-4 flex gap-4 flex-wrap">
  <input type="text" id="search" placeholder="Search nama/NIK/KTA..." class="border p-2 rounded-xl flex-1">
</div>

<div class="overflow-x-auto">
  <table class="min-w-full bg-white rounded-xl shadow-lg overflow-hidden" id="table">
    <thead class="bg-red-700 text-white">
      <tr>
        <th class="px-4 py-2">Nama</th>
        <th class="px-4 py-2">NIK</th>
        <th class="px-4 py-2">KTA</th>
        <th class="px-4 py-2">Detail</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>
</div>

<!-- Modal Resume -->
<div id="modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden">
  <div class="bg-white rounded-2xl p-6 max-w-xl w-full relative">
    <button onclick="closeModal()" class="absolute top-2 right-2 text-red-700 font-bold text-xl">&times;</button>
    <div id="modalContent"></div>
  </div>
</div>

<script>
const endpoint="PASTE_DOGET_ENDPOINT_GAS_DISINI";
let allData=[];

function renderTable(data){
  const tbody=document.getElementById("tbody");
  tbody.innerHTML="";
  data.forEach((d,idx)=>{
    tbody.innerHTML+=`<tr class="border-b cursor-pointer" onclick="showResume(${idx})">
      <td class="px-4 py-2">${d.nama}</td>
      <td class="px-4 py-2">${d.nik}</td>
      <td class="px-4 py-2">${d.kta}</td>
      <td class="px-4 py-2 text-blue-600 hover:underline">Lihat</td>
    </tr>`;
  });
}

function showResume(idx){
  const d=allData[idx];
  let html=`<div class="flex gap-4">
    <div class="flex-1">
      <h2 class="text-xl font-bold">${d.nama}</h2>
      <p>NIK: ${d.nik}</p>
      <p>KTA: ${d.kta}</p>
      <h3 class="font-semibold mt-2">Pendidikan Formal</h3>`;
  d.pendidikanFormal.forEach(p=>{
    html+=`<p>${p.nama} (${p.tahun}) ${p.jurusan? "| "+p.jurusan:""}</p>`;
  });
  html+=`<h3 class="font-semibold mt-2">Pendidikan Kader</h3>`;
  d.pendidikanKader.forEach(p=>{
    html+=`<p>${p.nama} (${p.tahun}) | ${p.penyelenggara}</p>`;
  });
  html+=`</div>
    <div class="w-32"><img src="${d.foto}" class="rounded-xl object-cover w-32 h-32"></div>
  </div>`;
  document.getElementById("modalContent").innerHTML=html;
  document.getElementById("modal").classList.remove("hidden");
}

function closeModal(){ document.getElementById("modal").classList.add("hidden"); }

async function fetchData(){
  try{
    const res=await axios.get(endpoint);
    allData=res.data;
    renderTable(allData);
  }catch(err){
    console.error(err);
    alert("Gagal ambil data.");
  }
}

document.getElementById("search").addEventListener("input",e=>{
  const q=e.target.value.toLowerCase();
  const filtered=allData.filter(d=>d.nama.toLowerCase().includes(q) || d.nik.includes(q) || d.kta.includes(q));
  renderTable(filtered);
});

fetchData();
</script>

</body>
</html>
