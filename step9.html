<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Step 9 – Review & Kirim</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

<div class="max-w-2xl mx-auto p-4">
<div class="bg-white rounded-2xl shadow-xl p-6 space-y-6">

<h2 class="text-lg font-bold text-center">Review & Kirim</h2>

<div id="review"></div>

<div class="flex gap-3 pt-2">
  <button onclick="kirimData()" class="w-full bg-red-700 text-white py-3 rounded-xl font-semibold">✅ Kirim Data</button>
</div>

</div></div>

<script>
const data = JSON.parse(localStorage.getItem("formKader") || "{}");
if(!data.nik) window.location.href="step1.html";

const review = document.getElementById("review");

function buatSection(title, contentHtml){
  const div = document.createElement("div");
  div.className="space-y-2 border-b pb-2";
  div.innerHTML = `<h3 class="font-semibold text-gray-700">${title}</h3><div>${contentHtml}</div>`;
  return div;
}

// Data Pribadi
let pribadiHtml = `Nama: ${data.nama}<br>NIK: ${data.nik}<br>KTA: ${data.kta}<br>
<img src="${data.foto}" class="w-32 h-32 object-cover rounded-xl mt-2">`;
review.appendChild(buatSection("Data Pribadi", pribadiHtml));

// Pendidikan Formal
let pfHtml = "";
(data.pendidikanFormal||[]).forEach(p=>{
  pfHtml += `${p.nama} (${p.tahun})${p.jurusan ? " | "+p.jurusan : ""}<br>`;
});
review.appendChild(buatSection("Pendidikan Formal", pfHtml||"-"));

// Pendidikan Kader
let pkHtml = "";
(data.pendidikanKader||[]).forEach(p=>{
  pkHtml += `${p.nama} (${p.tahun}) | ${p.penyelenggara}<br>`;
});
review.appendChild(buatSection("Pendidikan Kader", pkHtml||"-"));

// Tambahkan bagian lain sesuai step5-step8...

async function kirimData(){
  try{
    const res = await fetch("https://script.google.com/macros/s/AKfycbxcZqExieC2H5zw3FHkwRVcpS_3hsrmPIwluH0dnmzmIk1BYjDAk2lyVQHArK8CA7zW/exec",{
      method:"POST",
      body:JSON.stringify(data)
    });
    const result = await res.json();
    if(result.status==="success"){
      alert("Data berhasil dikirim!");
      localStorage.removeItem("formKader");
      window.location.href="terima.html";
    }else{
      alert("Gagal kirim: "+result.message);
    }
  }catch(err){
    alert("Error: "+err.message);
  }
}
</script>

</body>
</html>
